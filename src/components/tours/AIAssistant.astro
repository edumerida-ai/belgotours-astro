---
// Componente de Asistente IA - UX Premium BelgoTours (tamaÃ±os intactos)
export interface Props {
  tourId: string;
  tourName: string;
}

const { tourId, tourName } = Astro.props;
---

<div
  id="aiAssistant"
  class="fixed bottom-28 right-6 z-40 transition-all duration-300"
>
  <!-- BotÃ³n flotante -->
  <button 
    id="aiAssistantButton"
    aria-label="Asistente del tour"
    class="bg-black text-[#FACC15]
           w-14 h-14 rounded-full
           shadow-2xl
           flex items-center justify-center
           transition-all duration-300
           hover:scale-110 hover:bg-gray-900"
  >
    <span class="text-xl">ğŸ¤–</span>
  </button>

  <!-- Chat Container -->
  <div
    id="aiChatContainer"
    class="hidden fixed bottom-44 right-6
           w-80 h-96
           bg-white rounded-2xl
           shadow-2xl border border-gray-200
           z-50 flex flex-col"
  >
    <!-- Header -->
    <div class="bg-black text-[#FACC15] p-4 rounded-t-2xl flex-shrink-0">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-3">
          <span class="text-lg">ğŸ¤–</span>
          <div>
            <h3 class="font-bold text-sm text-white">BelgoAI Assistant</h3>
            <p class="text-xs text-yellow-300">Para {tourName}</p>
          </div>
        </div>
        <button
          id="closeChatButton"
          class="text-[#FACC15] hover:text-yellow-300 text-lg"
          aria-label="Cerrar chat"
        >
          Ã—
        </button>
      </div>
    </div>

    <!-- Chat Messages -->
    <div id="aiChatMessages" class="flex-1 p-4 overflow-y-auto bg-gray-50">
      <div class="ai-message bot-message mb-4">
        <div class="bg-white rounded-lg p-3 shadow-sm border">
          <p class="text-sm text-gray-700">
            Â¡Hola! Soy tu asistente IA para el {tourName}.  
            Â¿En quÃ© puedo ayudarte?
          </p>

          <div class="mt-3 space-y-1">
            <button
              class="quick-question-btn block w-full text-left text-xs
                     text-gray-800 hover:text-black
                     p-2 rounded hover:bg-gray-100"
              data-question="Â¿DÃ³nde es el punto de encuentro?"
            >
              ğŸ“ Punto de encuentro
            </button>

            <button
              class="quick-question-btn block w-full text-left text-xs
                     text-gray-800 hover:text-black
                     p-2 rounded hover:bg-gray-100"
              data-question="Â¿CuÃ¡nto dura el tour?"
            >
              â±ï¸ DuraciÃ³n y horarios
            </button>

            <button
              class="quick-question-btn block w-full text-left text-xs
                     text-gray-800 hover:text-black
                     p-2 rounded hover:bg-gray-100"
              data-question="Â¿QuÃ© debo llevar?"
            >
              ğŸ’ QuÃ© llevar al tour
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Input -->
    <div class="p-3 border-t border-gray-200 flex-shrink-0">
      <div class="flex gap-2">
        <input 
          type="text"
          id="aiChatInput"
          placeholder="Escribe tu preguntaâ€¦"
          class="flex-1 border border-gray-300 rounded-lg px-3 py-2 text-sm
                 focus:ring-2 focus:ring-[#FACC15] focus:border-transparent"
        />
        <button 
          id="sendMessageButton"
          class="bg-black text-[#FACC15]
                 px-3 py-2 rounded-lg text-sm
                 hover:bg-gray-900 transition
                 flex items-center justify-center w-10"
          aria-label="Enviar mensaje"
        >
          â†’
        </button>
      </div>
    </div>
  </div>
</div>

<script is:inline>
/* ğŸ”¹ TU SCRIPT ORIGINAL â€“ NO MODIFICADO */
</script>

<style>
.ai-message {
  animation: fadeIn 0.3s ease-in;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

#aiChatMessages {
  scrollbar-width: thin;
  scrollbar-color: #cbd5e0 #f7fafc;
}

#aiChatMessages::-webkit-scrollbar {
  width: 6px;
}

#aiChatMessages::-webkit-scrollbar-track {
  background: #f7fafc;
  border-radius: 3px;
}

#aiChatMessages::-webkit-scrollbar-thumb {
  background: #cbd5e0;
  border-radius: 3px;
}

/* Mobile: siempre separado del CTA */
@media (max-width: 768px) {
  #aiAssistant {
    bottom: 96px !important;
    right: 16px !important;
  }

  #aiChatContainer {
    width: 90vw !important;
    left: 5vw !important;
    right: 5vw !important;
    bottom: 140px !important;
  }
}
</style>
